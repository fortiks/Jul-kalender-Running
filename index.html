<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <div id="infoBox"></div>
  <title>Jul Kalender Challenge</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <h1>Jul Kalender Challenge</h1>
  <button id="musicToggle">ðŸŽµ Play Music</button>
  <audio id="bgMusic" loop>
    <source src="beautiful-christmas-426337.mp3" type="audio/mpeg">
  </audio>
  <table id="challenge"></table>

  <script>
    fetch('Challenge.csv')
      .then(r => r.text())
      .then(csv => {
        const table = document.getElementById('challenge');
        const rows = csv.split('\n');
        rows.forEach((row, i) => {
          const tr = document.createElement('tr');
          const cells = row.split(',');
          cells.forEach(cell => {
            const td = document.createElement(i===0 ? 'th' : 'td');
            const value = cell.replace(/"/g,'').trim();
            td.textContent = value;
            if (value === "Yes") td.classList.add('Yes');
            if (value === "No") td.classList.add('No');
            tr.appendChild(td);
          });
          table.appendChild(tr);
        });
      });
  </script>
  <script>
  // --- Snowfall effect ---
  function createSnowflake() {
    const snowflake = document.createElement('div');
    snowflake.classList.add('snowflake');
    snowflake.textContent = 'â„';

    // random horizontal start position
    snowflake.style.left = Math.random() * 100 + 'vw';

    // random size
    snowflake.style.fontSize = (Math.random() * 12 + 8) + 'px';

    // random animation duration
    snowflake.style.animationDuration = (Math.random() * 5 + 5) + 's';

    document.body.appendChild(snowflake);

    // remove after falling
    setTimeout(() => snowflake.remove(), 10000);
  }
  setInterval(createSnowflake, 200);
</script>
<script>
  // Music 
  const music = document.getElementById('bgMusic');
  const btn = document.getElementById('musicToggle');
  let isPlaying = false;

  btn.addEventListener('click', () => {
    if (!isPlaying) {
      music.play();
      isPlaying = true;
      btn.textContent = "ðŸ”Š Music On";
      btn.classList.add("active");
    } else {
      music.pause();
      isPlaying = false;
      btn.textContent = "ðŸŽµ Play Music";
      btn.classList.remove("active");
    }
  });
</script>
<script>
// --- Required distance calculator ---
function updateRequirements() {
  const today = new Date();
  const start = new Date(today.getFullYear(), 11, 1); // Dec 1
  const end = new Date(today.getFullYear(), 11, 24); // Dec 24

  // Determine which day number we are on
  let dayNumber = Math.floor((today - start) / (1000*60*60*24)) + 1;

  if (dayNumber < 1) dayNumber = 1;
  if (dayNumber > 24) dayNumber = 24;

  // Required today = dayNumber / 2
  const requiredToday = dayNumber / 2;

  // Total required up to today = 0.25 Ã— n Ã— (n + 1)
  const totalRequired = 0.25 * dayNumber * (dayNumber + 1);

  const box = document.getElementById('requirements');
  document.getElementById("infoBox").innerHTML = `
  <b>Dagens datum:</b> ${today.toLocaleDateString()}<br>
  <b>Dag i utmaningen:</b> ${dayNumber}<br><br>

  <b>Krav idag:</b> ${requiredToday.toFixed(2)} km<br>
  <b>Totalt krav hittills:</b> ${totalRequired.toFixed(2)} km
`;
}

updateRequirements();
</script>
</body>
</html>
